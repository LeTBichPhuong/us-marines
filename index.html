<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <title>In tên trên áo</title>
    <style>
        body {
            background: #777;
            display: flex;
            justify-content: center;
            padding: 40px;
            font-family: Arial, sans-serif;
        }

        .product-preview {
            position: relative;
            width: 600px;
        }

        .product-preview img {
            width: 100%;
            display: block;
        }

        /* Lớp in chữ */
        .print-layer {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
        }
    </style>
</head>
<body>

<div class="product-preview">
    <!-- Ảnh áo -->
    <img src="us-marines.jpg" alt="Áo">

    <!-- SVG in chữ -->
    <svg class="print-layer" viewBox="0 0 1024 1024">

        <!-- Patch nền -->
        <rect
            id="nameBg"
            x="130"
            y="519"
            rx="3"
            ry="3"
            width="140"
            fill="#565559"
            stroke="#dec27a"
            stroke-width="1"
        />

        <!-- Chữ -->
        <text
            id="printName"
            x="136"
            y="539"
            fill="#dec27a"
            font-size="16"
            font-weight="600"
            letter-spacing="0.2"
        >
        </text>

    </svg>
</div>

<script>
    const params = new URLSearchParams(window.location.search);
    const name = params.get('name');

    const text = document.getElementById('printName');
    const bg = document.getElementById('nameBg');

    const SHORT_LIMIT = 10;

    const paddingX = 6;
    const paddingY = 4;

    const baseFontSize = 16;
    const minFontSize = 11;
    const maxPatchWidth = 160;

    if (!name) {
        bg.style.display = 'none';
    } else {
        text.textContent = name.toUpperCase();
        text.setAttribute('font-size', baseFontSize);

        requestAnimationFrame(() => {
            let fontSize = baseFontSize;
            let box = text.getBBox();

            // giu nguyen patch vs text neu ky tu ngan
            if (name.length <= SHORT_LIMIT) {
                bg.setAttribute('width', box.width + paddingX * 2);
                bg.setAttribute('height', box.height + paddingY * 2);
                return;
            }

            // can chinh ky tu dai
            bg.setAttribute('x', 98);
            bg.setAttribute('y', 524);

            text.setAttribute('x', 105);
            text.setAttribute('y', 539);

            // Thu nhỏ chữ
            while (
                box.width + paddingX * 2 > maxPatchWidth &&
                fontSize > minFontSize
            ) {
                fontSize--;
                text.setAttribute('font-size', fontSize);
                box = text.getBBox();
            }

            // Patch ôm chữ
            bg.setAttribute('width', box.width + paddingX * 2);
            bg.setAttribute('height', box.height + paddingY * 2);
        });
    }
</script>




</body>
</html>
